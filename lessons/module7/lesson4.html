<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 4: Object Destructuring - JavaScript Journey</title>
    <link rel="stylesheet" href="../../styles/main.css">
    <link rel="stylesheet" href="../../styles/themes.css">
    <link rel="stylesheet" href="../../styles/lesson.css">
    <link rel="stylesheet" href="../../styles/dark-mode-fixes.css">
    <link rel="stylesheet" href="../../styles/code-highlighting.css">
    <link rel="stylesheet" href="../../styles/footer.css">
    <link rel="stylesheet" href="../../styles/header-enhanced.css">
    <link rel="stylesheet" href="../../styles/modal.css">
    <link rel="stylesheet" href="../../styles/style-guide.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="../../index.html" style="text-decoration: none; color: inherit;">
                    <i class="fas fa-code"></i>
                    <span>JavaScript Journey</span>
                </a>
            </div>
            <div class="nav-menu">
                <button class="nav-btn" onclick="window.location.href='../../index.html'">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </button>
                <button class="nav-btn" id="progressBtn">
                    <i class="fas fa-chart-line"></i>
                    <span>Progress</span>
                </button>
                <button class="nav-btn" id="resetBtn">
                    <i class="fas fa-redo"></i>
                    <span>Reset</span>
                </button>
                <button class="nav-btn" id="themeBtn">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </nav>

    <main class="lesson-container">
        <article class="lesson-content">
            <!-- Lesson Header -->
            <div class="lesson-header">
                <h1>Module 7:<br>Lesson 4: Object Destructuring</h1>
                <p class="lesson-subtitle">Extract object properties into variables with elegant ES6 syntax that makes your code cleaner and more readable</p>
            </div>

            <!-- Introduction Section -->
            <section class="content-section">
                <h2>Introduction to Object Destructuring</h2>
                <p>Imagine you have a toolbox with many compartments, and you need to quickly grab specific tools for a job. Instead of opening the toolbox and reaching for each tool one by one, object destructuring is like having magical hands that can extract exactly the tools you need in one swift motion. It's a elegant way to unpack properties from objects into distinct variables.</p>
                <p>Object destructuring is one of the most powerful features introduced in ES6. It transforms verbose, repetitive code into clean, readable expressions. Whether you're handling API responses, function parameters, or configuration objects, destructuring makes your code more professional and easier to understand.</p>
            </section>

            <!-- Core Content Section 1 -->
            <section class="content-section">
                <h2>Basic Object Destructuring</h2>
                <p>Object destructuring uses curly braces to extract properties from objects into variables with matching names. It's like giving JavaScript a shopping list of properties you want to extract:</p>

                <div class="info-box">
                    <div>
                        <i class="fas fa-lightbulb"></i> <strong> Key Insight:</strong>
                        <p>Object destructuring extracts properties by name. The variable names must match the property names, or you can rename them using the colon syntax.</p>
                    </div>
                </div>

                <div class="code-editor" id="editor1">
                    <div class="editor-header">
                        <div class="editor-tabs">
                            <button class="editor-tab active">Basic Destructuring</button>
                        </div>
                        <div class="editor-actions">
                            <button class="editor-btn copy-btn" onclick="copyCode('editor1')">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button class="editor-btn run-btn" onclick="runCode('editor1')">
                                <i class="fas fa-play"></i> Run Code
                            </button>
                        </div>
                    </div>
                    <div class="editor-content">
                        <textarea class="code-input" id="editor1-code">
// User profile object
const user = {
    id: 1001,
    username: "javascriptFan",
    email: "fan@example.com",
    firstName: "Alex",
    lastName: "Johnson",
    age: 28,
    city: "Portland",
    country: "USA",
    isActive: true
};

console.log("=== Traditional Property Access ===");
const userId = user.id;
const userEmail = user.email;
const userName = user.firstName;
const userAge = user.age;

console.log("Traditional way:");
console.log("ID:", userId);
console.log("Email:", userEmail);
console.log("Name:", userName);
console.log("Age:", userAge);

console.log("\n=== Object Destructuring Magic ===");
// Extract multiple properties in one line!
const { id, email, firstName, age } = user;

console.log("Destructured way:");
console.log("ID:", id);
console.log("Email:", email);
console.log("Name:", firstName);
console.log("Age:", age);

console.log("\n=== Renaming Variables During Destructuring ===");
// Extract properties with different variable names
const { 
    username: handle,           // Extract username as 'handle'
    city: location,            // Extract city as 'location'  
    isActive: activeStatus     // Extract isActive as 'activeStatus'
} = user;

console.log("Renamed variables:");
console.log("Handle:", handle);
console.log("Location:", location);
console.log("Active:", activeStatus);

console.log("\n=== Extracting Remaining Properties ===");
// Extract some properties, ignore others
const { lastName, country, ...otherInfo } = user;
console.log("Last name:", lastName);
console.log("Country:", country);
console.log("Other info:", otherInfo);

console.log("\n=== Real-world Example: API Response ===");
const apiResponse = {
    status: "success",
    data: {
        products: ["laptop", "mouse", "keyboard"],
        total: 3,
        page: 1
    },
    message: "Products fetched successfully",
    timestamp: "2024-01-15T10:30:00Z"
};

// Extract what we need from the API response
const { status, message, data } = apiResponse;
console.log(`API Status: ${status}`);
console.log(`Message: ${message}`);
console.log(`Data:`, data);
</textarea>
                        <div class="code-output">
                            <div class="output-label">Output will appear here...</div>
                            <pre id="editor1-output"></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Core Content Section 2 -->
            <section class="content-section">
                <h2>Default Values and Nested Destructuring</h2>
                <p>Sometimes objects don't have all the properties you expect, or you need to extract properties from nested objects. Destructuring handles these scenarios elegantly with default values and nested patterns:</p>

                <div class="code-editor" id="editor2">
                    <div class="editor-header">
                        <div class="editor-tabs">
                            <button class="editor-tab active">Advanced Destructuring</button>
                        </div>
                        <div class="editor-actions">
                            <button class="editor-btn copy-btn" onclick="copyCode('editor2')">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button class="editor-btn run-btn" onclick="runCode('editor2')">
                                <i class="fas fa-play"></i> Run Code
                            </button>
                        </div>
                    </div>
                    <div class="editor-content">
                        <textarea class="code-input" id="editor2-code">
console.log("=== Default Values ===");
// Object with some missing properties
const partialUser = {
    name: "Sarah",
    email: "sarah@example.com",
    // age is missing
    // role is missing
};

// Provide default values for missing properties
const { 
    name, 
    email, 
    age = 25,                    // Default to 25 if age is missing
    role = "user",               // Default to "user" if role is missing
    premium = false              // Default to false if premium is missing
} = partialUser;

console.log("Name:", name);
console.log("Email:", email);
console.log("Age:", age);         // Uses default value
console.log("Role:", role);       // Uses default value
console.log("Premium:", premium); // Uses default value

console.log("\n=== Nested Object Destructuring ===");
const company = {
    name: "TechCorp",
    founded: 2020,
    address: {
        street: "123 Innovation Ave",
        city: "San Francisco",
        state: "CA",
        zipCode: "94107",
        coordinates: {
            lat: 37.7749,
            lng: -122.4194
        }
    },
    ceo: {
        name: "Emma Wilson",
        age: 45,
        email: "emma@techcorp.com"
    }
};

// Extract nested properties directly
const {
    name: companyName,
    founded,
    address: {
        city: companyCity,
        state,
        coordinates: { lat, lng }
    },
    ceo: {
        name: ceoName,
        email: ceoEmail
    }
} = company;

console.log("Company:", companyName);
console.log("Founded:", founded);
console.log("City:", companyCity);
console.log("State:", state);
console.log("Coordinates:", lat, lng);
console.log("CEO:", ceoName);
console.log("CEO Email:", ceoEmail);

console.log("\n=== Nested Destructuring with Defaults ===");
const settings = {
    theme: "dark",
    language: "en",
    notifications: {
        email: true,
        // push is missing - will use default
        // sms is missing - will use default
    }
    // privacy object is missing completely
};

// Extract with nested defaults
const {
    theme = "light",
    language = "en",
    notifications: {
        email: emailNotifications = false,
        push: pushNotifications = true,
        sms: smsNotifications = false
    } = {},  // Default empty object if notifications is missing
    privacy: {
        publicProfile = false,
        shareData = false
    } = {}   // Default empty object if privacy is missing
} = settings;

console.log("Theme:", theme);
console.log("Language:", language);
console.log("Email notifications:", emailNotifications);
console.log("Push notifications:", pushNotifications);
console.log("SMS notifications:", smsNotifications);
console.log("Public profile:", publicProfile);
console.log("Share data:", shareData);
</textarea>
                        <div class="code-output">
                            <div class="output-label">Output will appear here...</div>
                            <pre id="editor2-output"></pre>
                        </div>
                    </div>
                </div>

                <div class="warning-box">
                    <div>
                        <i class="fas fa-exclamation-triangle"></i> <strong> Important:</strong>
                        <p>When destructuring nested objects, if a parent property doesn't exist, you'll get an error. Always provide default empty objects `= {}` for nested destructuring to be safe.</p>
                    </div>
                </div>
            </section>

            <!-- Core Content Section 3 -->
            <section class="content-section">
                <h2>Destructuring in Function Parameters</h2>
                <p>One of the most powerful applications of object destructuring is in function parameters. Instead of passing multiple arguments or accessing properties inside the function, you can destructure the object right in the parameter list:</p>

                <div class="code-editor" id="editor3">
                    <div class="editor-header">
                        <div class="editor-tabs">
                            <button class="editor-tab active">Function Parameter Destructuring</button>
                        </div>
                        <div class="editor-actions">
                            <button class="editor-btn copy-btn" onclick="copyCode('editor3')">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button class="editor-btn run-btn" onclick="runCode('editor3')">
                                <i class="fas fa-play"></i> Run Code
                            </button>
                        </div>
                    </div>
                    <div class="editor-content">
                        <textarea class="code-input" id="editor3-code">
console.log("=== Traditional Function with Object Parameter ===");

// Old way - accessing properties inside function
function createUserCard_Old(user) {
    return `
        Name: ${user.firstName} ${user.lastName}
        Email: ${user.email}
        Age: ${user.age}
        Role: ${user.role || 'User'}
    `;
}

const userData = {
    firstName: "John",
    lastName: "Doe", 
    email: "john@example.com",
    age: 30
};

console.log("Old way:", createUserCard_Old(userData));

console.log("\n=== Modern Function with Destructured Parameters ===");

// New way - destructure directly in parameters!
function createUserCard({ firstName, lastName, email, age, role = 'User' }) {
    return `
        Name: ${firstName} ${lastName}
        Email: ${email}
        Age: ${age}
        Role: ${role}
    `;
}

console.log("Modern way:", createUserCard(userData));

console.log("\n=== Complex Example: Order Processing ===");

function processOrder({
    orderId,
    customer: { name: customerName, email },
    items,
    shipping: { method = 'standard', cost = 0 } = {},
    payment: { method: paymentMethod, total }
}) {
    return `
Order #${orderId} processed:
Customer: ${customerName} (${email})
Items: ${items.length} items
Shipping: ${method} ($${cost})
Payment: ${paymentMethod} - Total: $${total}
    `;
}

const order = {
    orderId: "ORD-2024-001",
    customer: {
        name: "Alice Smith",
        email: "alice@example.com"
    },
    items: [
        { name: "Laptop", price: 999 },
        { name: "Mouse", price: 25 }
    ],
    shipping: {
        method: "express",
        cost: 15
    },
    payment: {
        method: "credit card",
        total: 1039
    }
};

console.log(processOrder(order));

console.log("\n=== Configuration Objects ===");

// Perfect for handling options/config objects
function createChart({
    title = 'Untitled Chart',
    type = 'bar',
    data = [],
    options: {
        width = 400,
        height = 300,
        showLegend = true,
        colors = ['#blue', '#red', '#green']
    } = {}
} = {}) {  // Default to empty object if no argument passed
    return {
        title,
        type,
        data,
        config: {
            dimensions: `${width}x${height}`,
            features: {
                legend: showLegend,
                colorScheme: colors
            }
        }
    };
}

// Various ways to call the function
console.log("Default chart:", createChart());

console.log("Custom chart:", createChart({
    title: 'Sales Data',
    type: 'line',
    data: [100, 200, 150],
    options: {
        width: 600,
        height: 400
    }
}));

console.log("\n=== Array of Objects Destructuring ===");

const employees = [
    { name: 'John', department: 'Engineering', salary: 75000 },
    { name: 'Sarah', department: 'Design', salary: 65000 },
    { name: 'Mike', department: 'Marketing', salary: 60000 }
];

// Destructure in array methods
console.log("=== Employee Summary ===");
employees.forEach(({ name, department, salary }) => {
    console.log(`${name} works in ${department} and earns $${salary}`);
});

// Map with destructuring
const employeeSummary = employees.map(({ name, department }) => 
    `${name} (${department})`
);
console.log("Summary:", employeeSummary);
</textarea>
                        <div class="code-output">
                            <div class="output-label">Output will appear here...</div>
                            <pre id="editor3-output"></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Practice Exercise 1 -->
            <section class="exercise-section">
                <div class="exercise-header">
                    <h3><i class="fas fa-puzzle-piece"></i> Practice Exercise 1: Extract User Data</h3>
                </div>
                <div class="exercise-content">
                    <p>Use object destructuring to extract the specified properties from the user object and log them:</p>
                    
                    <div class="code-editor" id="exercise1">
                        <div class="editor-header">
                            <div class="editor-tabs">
                                <button class="editor-tab active">Extract Properties</button>
                            </div>
                            <div class="editor-actions">
                                <button class="editor-btn copy-btn" onclick="copyCode('exercise1')">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                                <button class="editor-btn run-btn" onclick="checkExercise1()">
                                    <i class="fas fa-play"></i> Test Destructuring
                                </button>
                            </div>
                        </div>
                        <div class="editor-content">
                            <textarea class="code-input" id="exercise1-code">
const userProfile = {
    id: 12345,
    personal: {
        firstName: "Emma",
        lastName: "Thompson",
        age: 32
    },
    contact: {
        email: "emma.thompson@email.com",
        phone: "+1-555-0123"
    },
    preferences: {
        theme: "dark",
        language: "en",
        notifications: true
    },
    subscription: {
        plan: "premium",
        expires: "2024-12-31"
    }
};

// Your task: Use destructuring to extract:
// 1. id from the main object
// 2. firstName and age from personal
// 3. email from contact  
// 4. theme from preferences (rename it to 'userTheme')
// 5. plan from subscription (with default value 'free' if missing)

// Write your destructuring assignment here:
const {
    // Extract id
    
    // Extract nested properties
    personal: {
        // Extract firstName and age
        
    },
    contact: {
        // Extract email
        
    },
    preferences: {
        // Extract theme and rename to userTheme
        
    },
    subscription: {
        // Extract plan with default value 'free'
        
    }
} = userProfile;

// Log the extracted values
console.log("User ID:", id);
console.log("Name:", firstName);
console.log("Age:", age);
console.log("Email:", email);
console.log("Theme:", userTheme);
console.log("Plan:", plan);
</textarea>
                            <div class="code-output">
                                <div class="output-label">Output will appear here...</div>
                                <pre id="exercise1-output"></pre>
                            </div>
                        </div>
                    </div>
                    <div class="exercise-feedback" id="exercise1-feedback"></div>
                </div>
            </section>

            <!-- Practice Exercise 2 -->
            <section class="exercise-section">
                <div class="exercise-header">
                    <h3><i class="fas fa-puzzle-piece"></i> Practice Exercise 2: Destructuring Quiz</h3>
                </div>
                <div class="exercise-content">
                    <p>What does this destructuring assignment do?</p>
                    <pre><code>const { name: fullName, age = 18 } = person;</code></pre>
                    <div class="exercise-options" id="exercise2">
                        <button class="option-btn" data-answer="wrong">Extracts name and age with no changes</button>
                        <button class="option-btn" data-answer="correct">Extracts name into 'fullName' variable and age with default value 18</button>
                        <button class="option-btn" data-answer="wrong">Creates an object with fullName and age properties</button>
                        <button class="option-btn" data-answer="wrong">This syntax is invalid</button>
                    </div>
                    <div class="exercise-feedback" id="exercise2-feedback"></div>
                </div>
            </section>

            <!-- Practice Exercise 3 -->
            <section class="exercise-section">
                <div class="exercise-header">
                    <h3><i class="fas fa-puzzle-piece"></i> Practice Exercise 3: Settings Manager</h3>
                </div>
                <div class="exercise-content">
                    <p>Create a function that uses parameter destructuring to handle application settings:</p>
                    
                    <div class="code-editor" id="exercise3">
                        <div class="editor-header">
                            <div class="editor-tabs">
                                <button class="editor-tab active">Settings Function</button>
                            </div>
                            <div class="editor-actions">
                                <button class="editor-btn copy-btn" onclick="copyCode('exercise3')">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                                <button class="editor-btn run-btn" onclick="checkExercise3()">
                                    <i class="fas fa-play"></i> Test Settings
                                </button>
                            </div>
                        </div>
                        <div class="editor-content">
                            <textarea class="code-input" id="exercise3-code">
// Create a function that uses destructured parameters to handle settings
// The function should:
// - Accept an object with user settings
// - Provide default values for missing properties
// - Return a formatted settings summary

function applySettings({
    // Add destructured parameters here with defaults:
    // - name (required, no default)
    // - theme with default 'light'  
    // - language with default 'en'
    // - notifications object with email (default true) and push (default false)
    // - display object with fontSize (default 14) and darkMode (default false)
    
}) {
    // Return a formatted string with all the settings
    return `Settings for ${name}:
Theme: ${theme}
Language: ${language}
Email notifications: ${email ? 'enabled' : 'disabled'}
Push notifications: ${push ? 'enabled' : 'disabled'}
Font size: ${fontSize}px
Dark mode: ${darkMode ? 'on' : 'off'}`;
}

// Test data
const userSettings1 = {
    name: "Alice",
    theme: "dark",
    notifications: {
        email: true,
        push: true
    }
};

const userSettings2 = {
    name: "Bob",
    language: "es",
    display: {
        fontSize: 16
    }
};

const userSettings3 = {
    name: "Charlie"
    // Everything else should use defaults
};

// Test your function
console.log(applySettings(userSettings1));
console.log("\n" + "=".repeat(30) + "\n");
console.log(applySettings(userSettings2)); 
console.log("\n" + "=".repeat(30) + "\n");
console.log(applySettings(userSettings3));
</textarea>
                            <div class="code-output">
                                <div class="output-label">Output will appear here...</div>
                                <pre id="exercise3-output"></pre>
                            </div>
                        </div>
                    </div>
                    <div class="exercise-feedback" id="exercise3-feedback"></div>
                </div>
            </section>

            <!-- Common Mistakes Section -->
            <section class="content-section">
                <h2>Common Mistakes to Avoid</h2>
                <div class="mistake-box">
                    <div class="mistake-item">
                        <div>
                            <i class="fas fa-times-circle"></i> <strong> Trying to Destructure null or undefined</strong>
                            <p>Attempting to destructure `null` or `undefined` will throw an error. Always provide default values or check if the object exists before destructuring.</p>
                        </div>
                    </div>
                    <div class="mistake-item">
                        <div>
                            <i class="fas fa-times-circle"></i> <strong> Forgetting Default Objects for Nested Destructuring</strong>
                            <p>When destructuring nested properties, if the parent object doesn't exist, you'll get an error. Always provide `= {}` defaults for nested destructuring.</p>
                        </div>
                    </div>
                    <div class="mistake-item">
                        <div>
                            <i class="fas fa-times-circle"></i> <strong> Variable Name Conflicts</strong>
                            <p>Destructured variables create new variables in the current scope. Make sure they don't conflict with existing variable names, or use renaming syntax.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Summary Section -->
            <section class="content-section">
                <h2>Summary</h2>
                <div class="summary-box">
                    <h3>Key Takeaways:</h3>
                    <ul>
                        <li>Object destructuring extracts properties from objects into variables using curly brace syntax</li>
                        <li>Use the colon syntax `property: newName` to rename variables during destructuring</li>
                        <li>Provide default values with `property = defaultValue` for missing properties</li>
                        <li>Nested destructuring allows you to extract properties from deeply nested objects</li>
                        <li>Parameter destructuring in functions makes code cleaner and more self-documenting</li>
                    </ul>
                </div>
            </section>

            <!-- Spacing before navigation -->
            <div style="margin: 2rem 0;"></div>
            
            <!-- Lesson Navigation -->
            <div class="lesson-navigation">
                <button class="btn btn-secondary" onclick="window.location.href='lesson3.html'">
                    <i class="fas fa-arrow-left"></i> Previous Lesson
                </button>
                
                <button class="btn btn-primary" onclick="completeLesson()">
                    Complete Lesson <i class="fas fa-check"></i>
                </button>
                
                <button class="btn btn-secondary" onclick="window.location.href='lesson5.html'">
                    Next Lesson <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </article>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <p>Made by TayMcQuaya with <span class="heart">❤️</span></p>
            <div class="social-links">
                <a href="https://taymcquaya.com" target="_blank" rel="noopener noreferrer" aria-label="Personal Website">
                    <i class="fas fa-globe"></i>
                </a>
                <a href="https://x.com/TayMcQuaya" target="_blank" rel="noopener noreferrer" aria-label="X (Twitter)">
                    <i class="fa-brands fa-x-twitter"></i>
                </a>
                <a href="https://github.com/TayMcQuaya" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
                    <i class="fab fa-github"></i>
                </a>
            </div>
            <div class="copyright">
                <p>&copy; 2025 JavaScript Journey&trade; - All rights reserved</p>
            </div>
        </div>
    </footer>

    <!-- Reset Modal -->
    <div class="modal" id="resetModal">
        <div class="modal-content">
            <h3>Reset Progress</h3>
            <p>Choose what you want to reset:</p>
            <div class="modal-buttons">
                <button class="btn btn-danger" id="resetAllBtn">Reset All Progress</button>
                <button class="btn btn-warning" id="resetModuleBtn">Reset Current Module</button>
                <button class="btn btn-secondary" id="cancelResetBtn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../../js/app.js"></script>
    <script src="../../js/storage.js"></script>
    <script src="../../js/navigation.js"></script>
    <script src="../../js/progress.js"></script>
    <script src="../../js/exercises.js"></script>
    <script src="../../js/modal.js"></script>
    <script>
        // Complete lesson function
        function completeLesson() {
            Storage.saveProgress(7, 4, true);
            customModal.success('Fantastic! Object destructuring is a game-changer for writing clean, professional JavaScript code.', 'Congratulations!');
            
            setTimeout(() => {
                window.location.href = 'lesson5.html';
            }, 2000);
        }

        // Copy code function
        function copyCode(editorId) {
            const codeInput = document.getElementById(`${editorId}-code`);
            if (!codeInput) return;
            
            codeInput.select();
            codeInput.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                const button = event.target.closest('.editor-btn');
                const originalText = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check"></i> Copied!';
                setTimeout(() => {
                    button.innerHTML = originalText;
                }, 2000);
            } catch (err) {
                console.error('Failed to copy:', err);
            }
        }

        // Run code function
        function runCode(editorId) {
            const codeInput = document.getElementById(`${editorId}-code`);
            const outputPane = document.getElementById(`${editorId}-output`);
            
            if (!codeInput || !outputPane) return;
            
            const code = codeInput.value;
            
            // Clear the parent container to remove the "Output will appear here..." label
            const outputContainer = outputPane.parentElement;
            const outputLabel = outputContainer.querySelector('.output-label');
            if (outputLabel) {
                outputLabel.style.display = 'none';
            }
            
            outputPane.innerHTML = '';
            
            const originalConsoleLog = console.log;
            const logs = [];
            
            console.log = (...args) => {
                logs.push(args.map(arg => {
                    if (typeof arg === 'object') {
                        return JSON.stringify(arg, null, 2);
                    }
                    return String(arg);
                }).join(' '));
            };
            
            try {
                eval(code);
                
                if (logs.length > 0) {
                    outputPane.innerHTML = logs.map(log => 
                        `<div class="output-line">${escapeHtml(log)}</div>`
                    ).join('');
                } else {
                    outputPane.innerHTML = '<div class="output-line muted">No output</div>';
                }
            } catch (error) {
                outputPane.innerHTML = `<div class="output-error">Error: ${escapeHtml(error.message)}</div>`;
            } finally {
                console.log = originalConsoleLog;
            }
        }

        // Escape HTML function
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Exercise 1 checker
        function checkExercise1() {
            const code = document.getElementById('exercise1-code').value;
            const output = document.getElementById('exercise1-output');
            const feedback = document.getElementById('exercise1-feedback');
            
            // Clear the parent container to remove the "Output will appear here..." label
            const outputContainer = output.parentElement;
            const outputLabel = outputContainer.querySelector('.output-label');
            if (outputLabel) {
                outputLabel.style.display = 'none';
            }
            
            // Run the code first to show output
            runCode('exercise1');
            
            // Check if the output contains any errors
            const outputHasError = output.innerHTML.includes('output-error') || 
                                  output.innerHTML.includes('Error:');
            
            const hasId = code.includes('id') && code.includes('=');
            const hasFirstName = code.includes('firstName');
            const hasAge = code.includes('age');
            const hasEmail = code.includes('email');
            const hasThemeRename = code.includes('theme:') && code.includes('userTheme');
            const hasPlanDefault = code.includes('plan') && code.includes('=') && code.includes('free');
            const hasNestedStructure = code.includes('personal:') && code.includes('contact:') && code.includes('preferences:');
            
            // Hide feedback first to create animation effect
            feedback.style.display = 'none';
            feedback.className = 'exercise-feedback';
            feedback.classList.remove('show', 'success', 'error');
            
            setTimeout(() => {
                feedback.style.display = 'block';
                if (!outputHasError && hasId && hasFirstName && hasAge && hasEmail && hasThemeRename && hasPlanDefault && hasNestedStructure) {
                    feedback.className = 'exercise-feedback show success';
                    feedback.textContent = 'Perfect! You successfully used nested destructuring with renaming and default values. This is professional-level JavaScript!';
                } else if (outputHasError) {
                    feedback.className = 'exercise-feedback show error';
                    feedback.textContent = 'Your code has errors. Make sure your destructuring syntax is correct and follows the nested object structure.';
                } else {
                    feedback.className = 'exercise-feedback show error';
                    let missing = [];
                    if (!hasId) missing.push('id extraction');
                    if (!hasFirstName) missing.push('firstName extraction');
                    if (!hasAge) missing.push('age extraction');
                    if (!hasEmail) missing.push('email extraction');
                    if (!hasThemeRename) missing.push('theme renamed to userTheme');
                    if (!hasPlanDefault) missing.push('plan with default value');
                    feedback.textContent = `Missing or incorrect: ${missing.join(', ')}. Check the nested structure and syntax.`;
                }
            }, 150);
        }

        // Exercise 3 checker
        function checkExercise3() {
            const code = document.getElementById('exercise3-code').value;
            const output = document.getElementById('exercise3-output');
            const feedback = document.getElementById('exercise3-feedback');
            
            // Clear the parent container to remove the "Output will appear here..." label
            const outputContainer = output.parentElement;
            const outputLabel = outputContainer.querySelector('.output-label');
            if (outputLabel) {
                outputLabel.style.display = 'none';
            }
            
            // Run the code first to show output
            runCode('exercise3');
            
            // Check if the output contains any errors
            const outputHasError = output.innerHTML.includes('output-error') || 
                                  output.innerHTML.includes('Error:');
            
            const hasParameterDestructuring = code.includes('{') && code.includes('}') && code.includes('applySettings');
            const hasNameParameter = code.includes('name');
            const hasThemeDefault = code.includes('theme') && code.includes('=') && code.includes('light');
            const hasNestedNotifications = code.includes('notifications:') && code.includes('email') && code.includes('push');
            const hasNestedDisplay = code.includes('display:') && code.includes('fontSize') && code.includes('darkMode');
            const hasDefaultObjects = code.includes('= {}');
            
            // Hide feedback first to create animation effect
            feedback.style.display = 'none';
            feedback.className = 'exercise-feedback';
            feedback.classList.remove('show', 'success', 'error');
            
            setTimeout(() => {
                feedback.style.display = 'block';
                if (!outputHasError && hasParameterDestructuring && hasNameParameter && hasThemeDefault && hasNestedNotifications && hasNestedDisplay && hasDefaultObjects) {
                    feedback.className = 'exercise-feedback show success';
                    feedback.textContent = 'Excellent! Your function uses advanced parameter destructuring with nested objects and defaults. This is exactly how professional developers write flexible, robust functions!';
                } else if (outputHasError) {
                    feedback.className = 'exercise-feedback show error';
                    feedback.textContent = 'Your code has errors. Make sure the parameter destructuring syntax is correct and all variables are properly defined.';
                } else {
                    feedback.className = 'exercise-feedback show error';
                    let missing = [];
                    if (!hasParameterDestructuring) missing.push('parameter destructuring syntax');
                    if (!hasThemeDefault) missing.push('theme default value');
                    if (!hasNestedNotifications) missing.push('nested notifications destructuring');
                    if (!hasNestedDisplay) missing.push('nested display destructuring');
                    if (!hasDefaultObjects) missing.push('default empty objects');
                    feedback.textContent = `Missing: ${missing.join(', ')}. Check the destructuring syntax and default values.`;
                }
            }, 150);
        }

        // Exercise 2 - Multiple choice handler
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.option-btn').forEach(button => {
                button.addEventListener('click', function() {
                    if (this.disabled) return;
                    
                    const exerciseContainer = this.closest('.exercise-options');
                    const feedbackDiv = this.closest('.exercise-content').querySelector('.exercise-feedback');
                    const isCorrect = this.getAttribute('data-answer') === 'correct';
                    
                    // Remove previous incorrect selections (but not correct ones)
                    exerciseContainer.querySelectorAll('.option-btn').forEach(btn => {
                        if (btn.classList.contains('incorrect')) {
                            btn.classList.remove('incorrect', 'selected');
                            btn.disabled = false;
                        }
                    });
                    
                    // Hide feedback first to create animation effect
                    if (feedbackDiv) {
                        feedbackDiv.style.display = 'none';
                        feedbackDiv.className = 'exercise-feedback';
                        feedbackDiv.classList.remove('show', 'success', 'error');
                    }
                    
                    // Mark this button
                    this.classList.add('selected');
                    this.classList.add(isCorrect ? 'correct' : 'incorrect');
                    
                    if (isCorrect) {
                        // Correct answer - disable all buttons
                        exerciseContainer.querySelectorAll('.option-btn').forEach(btn => {
                            btn.disabled = true;
                        });
                    } else {
                        // Wrong answer - disable only this button
                        this.disabled = true;
                    }
                    
                    // Show feedback with animation
                    if (feedbackDiv) {
                        setTimeout(() => {
                            feedbackDiv.style.display = 'block';
                            feedbackDiv.className = 'exercise-feedback show ' + (isCorrect ? 'success' : 'error');
                            if (isCorrect) {
                                feedbackDiv.textContent = 'Correct! The colon renames the variable, and the equals provides a default value.';
                            } else {
                                feedbackDiv.textContent = 'Not quite. The colon (:) is for renaming, and equals (=) provides default values.';
                            }
                        }, 150);
                    }
                });
            });
        });
    </script>
</body>
</html>